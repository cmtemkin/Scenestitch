@tailwind base;
@tailwind components;
@tailwind utilities;

/* Custom styles for fixed layout and scrolling behavior */
.fixed-container {
  position: relative;
  overflow: hidden;
}

/* Prevent body scrolling when using the app */
body {
  overflow: hidden;
}

/* Ensure storyboard container scrolls properly */
.storyboard-container {
  -webkit-overflow-scrolling: touch;
  height: calc(100vh - 128px); /* Account for header and toolbar */
}

/* Mobile-friendly dialog content */
.DialogOverlay {
  -webkit-overflow-scrolling: touch;
}

[data-radix-dialog-content] {
  max-height: 80vh !important;
  overflow-y: auto !important;
  -webkit-overflow-scrolling: touch !important;
  overscroll-behavior: contain;
}

/* Mobile scroll container for main content */
.mobile-scroll-container {
  -webkit-overflow-scrolling: touch;
  overflow-y: auto;
  overscroll-behavior: contain;
}

/* Improved touch targets for mobile */
@media (max-width: 768px) {
  .touch-target {
    min-height: 44px;
    min-width: 44px;
  }
  
  /* Better button spacing on mobile */
  .mobile-button-spacing {
    padding: 12px 16px;
  }
  
  /* Improved form field sizing */
  .mobile-form-field {
    font-size: 16px; /* Prevents zoom on iOS */
  }
}

:root {
  /* Batman-inspired light theme */
  --background: 210 11% 96%;
  --foreground: 220 15% 8%;
  --muted: 210 10% 90%;
  --muted-foreground: 220 10% 40%;
  --popover: 210 11% 98%;
  --popover-foreground: 220 15% 8%;
  --card: 0 0% 100%;
  --card-foreground: 220 15% 8%;
  --border: 210 12% 82%;
  --input: 210 12% 89%;
  --primary: 45 100% 51%;
  --primary-foreground: 220 15% 8%;
  --secondary: 210 8% 88%;
  --secondary-foreground: 220 12% 12%;
  --accent: 210 20% 15%;
  --accent-foreground: 45 100% 51%;
  --destructive: 0 84% 60%;
  --destructive-foreground: 210 11% 96%;
  --ring: 45 100% 51%;
  --radius: 0.75rem;
  
  /* Batman color palette */
  --batman-dark: 220 15% 8%;
  --batman-charcoal: 215 12% 15%;
  --batman-slate: 210 10% 25%;
  --batman-yellow: 45 100% 51%;
  --batman-gold: 43 96% 56%;
  --batman-steel: 210 8% 45%;
  --batman-smoke: 210 8% 88%;
}

.dark {
  /* Batman-inspired dark theme (default) */
  --background: 220 15% 8%;
  --foreground: 210 11% 96%;
  --muted: 215 12% 15%;
  --muted-foreground: 210 8% 65%;
  --popover: 215 12% 12%;
  --popover-foreground: 210 11% 96%;
  --card: 215 12% 12%;
  --card-foreground: 210 11% 96%;
  --border: 210 10% 25%;
  --input: 215 12% 15%;
  --primary: 45 100% 51%;
  --primary-foreground: 220 15% 8%;
  --secondary: 210 10% 25%;
  --secondary-foreground: 210 11% 96%;
  --accent: 45 100% 51%;
  --accent-foreground: 220 15% 8%;
  --destructive: 0 84% 60%;
  --destructive-foreground: 210 11% 96%;
  --ring: 45 100% 51%;
  --radius: 0.75rem;
}

@layer base {
  * {
    @apply border-border;
  }

  html, body {
    @apply font-sans antialiased bg-background text-foreground;
    position: fixed;
    overflow: hidden;
    width: 100%;
    height: 100%;
    overscroll-behavior-y: none;
    -webkit-overflow-scrolling: touch;
    background: linear-gradient(135deg, hsl(var(--background)) 0%, hsl(var(--muted)) 100%);
  }

  #root {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    overflow: auto;
    height: 100%;
    -webkit-overflow-scrolling: touch;
  }

  /* Fix for iOS Safari momentum scrolling */
  .mobile-scroll-container {
    height: 100%;
    overflow-y: auto;
    -webkit-overflow-scrolling: touch;
  }
}

@layer components {
  /* Modern glassmorphism card */
  .glass-card {
    @apply bg-card/70 backdrop-blur-xl border border-border/50 shadow-2xl;
    background: linear-gradient(135deg, hsl(var(--card) / 0.7) 0%, hsl(var(--muted) / 0.3) 100%);
  }

  /* Modern button variants */
  .btn-primary {
    @apply bg-primary text-primary-foreground hover:bg-primary/90 font-semibold;
    background: linear-gradient(135deg, hsl(var(--primary)) 0%, hsl(var(--batman-gold)) 100%);
    box-shadow: 0 4px 20px hsl(var(--primary) / 0.3);
  }

  .btn-secondary {
    @apply bg-secondary/70 text-secondary-foreground hover:bg-secondary backdrop-blur-sm;
    border: 1px solid hsl(var(--border) / 0.5);
  }

  /* Audio-first workflow indicators */
  .workflow-step {
    @apply relative overflow-hidden;
  }

  .workflow-step::before {
    content: '';
    @apply absolute inset-0 bg-gradient-to-r from-primary/10 to-transparent opacity-0 transition-opacity duration-300;
  }

  .workflow-step.active::before {
    @apply opacity-100;
  }

  .workflow-step.completed {
    @apply border-l-4 border-primary;
  }

  /* Modern sidebar */
  .sidebar-modern {
    @apply bg-card/80 backdrop-blur-xl border-r border-border/30;
    background: linear-gradient(180deg, hsl(var(--card) / 0.9) 0%, hsl(var(--muted) / 0.7) 100%);
  }

  /* Enhanced responsive grid */
  .responsive-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
    gap: 1.5rem;
  }

  @media (max-width: 768px) {
    .responsive-grid {
      grid-template-columns: 1fr;
      gap: 1rem;
    }
  }

  @media (max-width: 480px) {
    .responsive-grid {
      grid-template-columns: 1fr;
      gap: 0.75rem;
    }
  }

  /* Mobile-first responsive containers */
  .mobile-container {
    @apply px-4 py-6;
  }

  @media (min-width: 640px) {
    .mobile-container {
      @apply px-6 py-8;
    }
  }

  @media (min-width: 1024px) {
    .mobile-container {
      @apply px-8 py-12;
    }
  }

  /* Mobile-friendly button sizing */
  @media (max-width: 768px) {
    .btn-mobile {
      @apply min-h-[44px] px-4 py-3 text-sm;
    }
    
    .btn-mobile-full {
      @apply w-full min-h-[48px] px-6 py-4;
    }
  }

  /* Mobile form spacing */
  .mobile-form-spacing > * + * {
    @apply mt-4;
  }

  @media (max-width: 640px) {
    .mobile-form-spacing > * + * {
      @apply mt-3;
    }
  }

  /* Modern scene cards */
  .scene-card {
    @apply glass-card transition-all duration-300 hover:scale-105 hover:shadow-xl;
    transform-origin: center;
  }

  .scene-card:hover {
    box-shadow: 0 20px 40px hsl(var(--primary) / 0.15);
  }

  /* Audio visualizer styling */
  .audio-visualizer {
    @apply relative overflow-hidden rounded-lg;
    background: linear-gradient(90deg, hsl(var(--primary) / 0.1) 0%, hsl(var(--accent) / 0.1) 100%);
    border: 1px solid hsl(var(--border) / 0.3);
    backdrop-filter: blur(10px);
  }

  /* Workflow step transitions */
  .workflow-step {
    @apply transition-all duration-300;
  }

  .workflow-step.completed {
    @apply text-primary;
  }

  .workflow-step:hover:not(.completed) {
    @apply -translate-y-0.5 text-primary;
  }

  /* Enhanced button styles for audio actions */
  .btn-primary {
    @apply font-semibold transition-all duration-300;
    background: linear-gradient(135deg, hsl(var(--primary)), hsl(var(--primary) / 0.8));
    color: hsl(var(--primary-foreground));
    border: none;
    box-shadow: 0 4px 20px hsl(var(--primary) / 0.3);
  }

  .btn-primary:hover {
    background: linear-gradient(135deg, hsl(var(--primary) / 0.9), hsl(var(--primary) / 0.7));
    @apply -translate-y-0.5;
    box-shadow: 0 6px 25px hsl(var(--primary) / 0.4);
  }

  .btn-secondary {
    @apply transition-all duration-300;
    background: hsl(var(--secondary) / 0.8);
    color: hsl(var(--secondary-foreground));
    border: 1px solid hsl(var(--border) / 0.5);
  }

  .btn-secondary:hover {
    background: hsl(var(--secondary));
    @apply -translate-y-0.5;
    box-shadow: 0 4px 15px hsl(var(--secondary) / 0.3);
  }

  /* Modern navigation */
  .nav-modern {
    @apply flex items-center space-x-2 px-2 py-1 bg-muted/50 rounded-full backdrop-blur-sm;
  }

  /* Mobile touch targets and spacing */
  @media (max-width: 768px) {
    /* Ensure minimum touch targets */
    .btn-mobile {
      @apply min-h-[44px] px-4 py-3 text-sm;
    }
    
    .btn-mobile-full {
      @apply w-full min-h-[48px] px-6 py-4;
    }

    /* Mobile-optimized card spacing */
    .mobile-card {
      @apply p-4 m-2;
    }

    /* Mobile form elements */
    .mobile-input {
      @apply min-h-[44px] text-base; /* Prevents zoom on iOS */
    }

    /* Mobile dropdown spacing */
    .mobile-dropdown-item {
      @apply py-3 px-4 min-h-[48px];
    }

    /* Mobile safe area padding */
    .mobile-safe-area {
      padding-bottom: env(safe-area-inset-bottom);
      padding-left: env(safe-area-inset-left);
      padding-right: env(safe-area-inset-right);
    }
  }

  /* Prevent text selection on buttons and interactive elements */
  .no-select {
    -webkit-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
    user-select: none;
  }

  /* Better focus visibility for accessibility */
  .focus-visible {
    @apply focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary focus-visible:ring-offset-2;
  }

  /* Smooth scrolling for better UX */
  html {
    scroll-behavior: smooth;
  }

  /* Prevent horizontal overflow */
  .container-safe {
    max-width: 100vw;
    overflow-x: hidden;
  }

  .nav-item {
    @apply flex items-center px-4 py-2 rounded-full text-sm font-medium transition-all duration-200 whitespace-nowrap;
  }

  .nav-item.active {
    @apply bg-primary text-primary-foreground shadow-lg;
  }

  .nav-item:not(.active) {
    @apply text-muted-foreground hover:text-foreground hover:bg-background/50;
  }

  /* Enhanced mobile text wrapping */
  .mobile-text-wrap {
    word-break: break-word;
    overflow-wrap: break-word;
    hyphens: auto;
    -webkit-hyphens: auto;
    -ms-hyphens: auto;
  }

  /* Better mobile card spacing and layout */
  @media (max-width: 639px) {
    .scene-card {
      margin-bottom: 0.75rem;
    }
    
    .scene-card .CardHeader {
      padding-bottom: 0.5rem;
    }
    
    .scene-card .CardContent {
      padding-top: 0;
    }

    /* Improved mobile grid layout */
    .responsive-grid {
      gap: 0.75rem;
      padding: 0 0.25rem;
    }

    /* Better mobile touch targets */
    .touch-target {
      min-height: 44px;
      min-width: 44px;
    }

    /* Mobile-specific audio card improvements */
    .audio-visualizer {
      padding: 0.5rem;
    }

    .audio-visualizer audio {
      height: 40px;
    }
  }

  /* Medium screens and up */
  @media (min-width: 640px) {
    .responsive-grid {
      grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
      gap: 1.5rem;
      padding: 0;
    }
  }

  /* iOS Safe Area Insets */
  .safe-area-inset {
    padding-top: env(safe-area-inset-top);
    padding-bottom: env(safe-area-inset-bottom);
    padding-left: env(safe-area-inset-left);
    padding-right: env(safe-area-inset-right);
  }

  .safe-area-bottom,
  .pb-safe {
    padding-bottom: max(0.75rem, env(safe-area-inset-bottom));
  }

  .safe-area-top {
    padding-top: env(safe-area-inset-top);
  }

  /* MacBook/Desktop optimizations */
  @media (min-width: 1280px) {
    .desktop-sidebar-collapsible {
      transition: width 0.3s ease-in-out, opacity 0.2s ease-in-out;
    }

    .desktop-sidebar-collapsible.collapsed {
      width: 0;
      opacity: 0;
      overflow: hidden;
    }
  }

  /* Ultrawide screen support for scene grids */
  @media (min-width: 1536px) {
    .ultrawide-grid-5 {
      grid-template-columns: repeat(5, minmax(0, 1fr));
    }
  }

  @media (min-width: 1920px) {
    .ultrawide-grid-6 {
      grid-template-columns: repeat(6, minmax(0, 1fr));
    }
  }

  /* Floating Action Button */
  .fab {
    @apply fixed z-40 w-14 h-14 rounded-full shadow-2xl flex items-center justify-center;
    @apply bg-primary text-primary-foreground;
    @apply transition-all duration-300 ease-out;
    @apply hover:scale-110 hover:shadow-primary/40;
    @apply active:scale-95;
    bottom: calc(5rem + env(safe-area-inset-bottom));
    right: 1rem;
  }

  .fab:hover {
    box-shadow: 0 8px 30px hsl(var(--primary) / 0.4);
  }

  @media (min-width: 1024px) {
    .fab {
      display: none;
    }
  }

  /* Improved swipe gesture support */
  .swipe-container {
    touch-action: pan-x pan-y;
    -webkit-overflow-scrolling: touch;
    scroll-snap-type: x mandatory;
    overflow-x: auto;
    scrollbar-width: none;
  }

  .swipe-container::-webkit-scrollbar {
    display: none;
  }

  .swipe-item {
    scroll-snap-align: center;
    scroll-snap-stop: always;
  }
}